/* eslint-disable no-undef */
import assert from 'assert'
import { NakoCompiler } from '../src/nako3.mjs'

describe('calc_test.js', async () => {
  const cmp = async (/** @type {string} */ code, /** @type {string} */ res) => {
    const nako = new NakoCompiler()
    assert.strictEqual((await nako.runAsync(code, 'main.nako3')).log, res)
  }
  const errorTest = async (/** @type {string} */ code, /** @type {string} */ errorType, /** @type {string} */ partOfErrorStr) => {
    const nako = new NakoCompiler()
    try {
      await nako.runAsync(code, 'main.nako3')
    } catch (err) {
      assert.strictEqual(errorType, err.type)
      assert.strictEqual(err.msg.indexOf(partOfErrorStr) >= 0, true)
    }
  }
  it('basic', async () => {
    await cmp('3„ÇíË°®Á§∫', '3')
    await cmp('3.14„ÇíË°®Á§∫', '3.14')
    await cmp('0.5e+3„ÇíË°®Á§∫', '500')
  })
  it('Ë∂≥„ÅóÁÆó', async () => {
    await cmp('3+5„ÇíË°®Á§∫', '8')
  })
  it('Âºï„ÅçÁÆó', async () => {
    await cmp('10-5„ÇíË°®Á§∫„ÄÇ', '5')
    await cmp('ÔºëÔºêÔºçÔºï„ÇíË°®Á§∫„ÄÇ', '5')
  })
  it('Êéõ„ÅëÁÆó', async () => {
    await cmp('1+2*3„ÇíË°®Á§∫', '7')
  })
  it('ÈÄ£Á∂öÊºîÁÆóÔºö„Åó„Å¶', async () => {
    await cmp('3„Å´5„ÇíË∂≥„Åó„Å¶Ë°®Á§∫', '8')
  })
  it('ÈÄ£Á∂öÊºîÁÆóÔºö„Å¶-3„Å´5„ÇíÊéõ„Åë„Å¶Ë°®Á§∫', async () => {
    await cmp('3„Å´5„ÇíÊéõ„Åë„Å¶Ë°®Á§∫', '15')
  })
  it('MAX', async () => {
    await cmp('10„Å®20„ÅÆMAX„ÇíË°®Á§∫', '20')
    await cmp('MAX(10, 20)„ÇíË°®Á§∫', '20')
    await cmp('MAX(10, 20, 30)„ÇíË°®Á§∫', '30')
  })
  it('ÊúÄÂ§ßÂÄ§', async () => {
    await cmp('10„Å®20„ÅÆÊúÄÂ§ßÂÄ§„ÇíË°®Á§∫', '20')
    await cmp('10„Å®20„Å®30„ÅÆÊúÄÂ§ßÂÄ§„ÇíË°®Á§∫', '30')
    await cmp('10„Å®10„ÅÆÊúÄÂ§ßÂÄ§„ÇíË°®Á§∫', '10')
  })
  it('MIN', async () => {
    await cmp('10„Å®20„ÅÆMIN„ÇíË°®Á§∫', '10')
    await cmp('MIN(10, 20)„ÇíË°®Á§∫', '10')
    await cmp('MIN(5, 10, 20, 30)„ÇíË°®Á§∫', '5')
  })
  it('ÊúÄÂ∞èÂÄ§', async () => {
    await cmp('10„Å®20„ÅÆÊúÄÂ∞èÂÄ§„ÇíË°®Á§∫', '10')
    await cmp('5„Å®10„Å®20„Å®30„ÅÆÊúÄÂ∞èÂÄ§„ÇíË°®Á§∫', '5')
    await cmp('10„Å®10„ÅÆÊúÄÂ∞èÂÄ§„ÇíË°®Á§∫', '10')
  })
  it('CLAMP', async () => {
    await cmp('10„ÅÆ20„Åã„Çâ30„Åæ„Åß„ÅÆCLAMP„ÇíË°®Á§∫', '20')
    await cmp('40„Çí20„Åã„Çâ30„ÅßCLAMP„Åó„Å¶Ë°®Á§∫', '30')
    await cmp('25„ÅÆ20„Åã„Çâ30„Åæ„Åß„ÅÆCLAMP„ÇíË°®Á§∫', '25')
    await cmp('CLAMP(10, 20, 30)„ÇíË°®Á§∫', '20')
    await cmp('CLAMP(20, 20, 30)„ÇíË°®Á§∫', '20')
    await cmp('CLAMP(30, 20, 30)„ÇíË°®Á§∫', '30')
  })
  it('ÈÖçÂàó', async () => {
    await cmp('a=[];a[1]=30;a[1]„ÇíË°®Á§∫', '30')
    await cmp('a=[];a„Äê1„Äë=30;a[1]„ÇíË°®Á§∫', '30')
  })
  it('„Éç„Çπ„ÉàÈÖçÂàó', async () => {
    await cmp('a=[[1,2,3], [4,5,6]];a[1][1]„ÇíË°®Á§∫', '5')
  })
  it('„Éç„Çπ„ÉàÈÖçÂàó„Åß„ÄÅ„Éû„Ç§„Éä„Çπ„ÇíÂê´„ÇÄ„Å®„Åç„ÅÆ„Éê„Ç∞‰øÆÊ≠£ (#276)', async () => {
    await cmp('a=[-1, -2, -3];a[0]„ÇíË°®Á§∫', '-1')
    await cmp('a=[-1, -2, -3];a[2]„ÇíË°®Á§∫', '-3')
    await cmp('a=[[-1, -1], [1, -1]];a[0][0]„ÇíË°®Á§∫', '-1')
  })
  it('„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà', async () => {
    await cmp('a={};a[\'a\']=30;a[\'a\']„ÇíË°®Á§∫', '30')
  })
  it('Èöé‰πó', async () => {
    await cmp('2^3„ÇíË°®Á§∫', '8')
  })
  it('Âê¶ÂÆö', async () => {
    await cmp('(!1)„ÇíË°®Á§∫', 'false')
    await cmp('(!0)„ÇíË°®Á§∫', 'true')
    await cmp('(!„Ç™„É≥)„ÇíË°®Á§∫', 'false')
    await cmp('(!„Ç™„Éï)„ÇíË°®Á§∫', 'true')
  })
  it('ÈÖçÂàóÁ∞°ÊòìË®òÂè∑', async () => {
    await cmp('A=[];A@0=5;A@0„ÇíË°®Á§∫', '5')
    await cmp('A=[];AÔº†0=5;AÔº†1=6;A„ÇíJSON„Ç®„É≥„Ç≥„Éº„Éâ„Åó„Å¶Ë°®Á§∫', '[5,6]')
  })
  it('JSONÈÖçÂàó-ÊîπË°å„ÅÇ„Çä', async () => {
    await cmp('A=[\n0,\n1,\n2,\n3];A@2„ÇíË°®Á§∫', '2')
  })
  it('JSONÈÖçÂàó-„Ç´„É≥„ÉûÁúÅÁï•', async () => {
    await cmp('A=[1 2 3 4 5];A„ÇíJSON„Ç®„É≥„Ç≥„Éº„Éâ„Åó„Å¶Ë°®Á§∫', '[1,2,3,4,5]')
  })
  it('JSONÈÖçÂàó-„Éç„Çπ„Éà', async () => {
    await cmp('A=[[1,2,3],[4,5,6]];A„ÇíJSON„Ç®„É≥„Ç≥„Éº„Éâ„Åó„Å¶Ë°®Á§∫', '[[1,2,3],[4,5,6]]')
  })
  it('JSON„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà-ÊîπË°å„ÅÇ„Çä', async () => {
    await cmp('A={\n"ÊÆø":"Áî∑","Âß´":"Â•≥"\n};A@"ÊÆø"„ÇíË°®Á§∫', 'Áî∑')
  })
  it('JSON„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà-ÂÄ§„ÇíÁúÅÁï•„Åó„ÅüÂ†¥Âêà', async () => {
    await cmp('N={"hoge"};N["hoge"]„ÇíË°®Á§∫„ÄÇ', 'hoge')
    await cmp('N={"hoge","fuga","bar"};N["bar"]„ÇíË°®Á§∫„ÄÇ', 'bar')
    await cmp('N={32,45,66};N[45]„ÇíË°®Á§∫„ÄÇ', '45')
  })
  it('JSON„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà-„Ç≠„Éº„ÇíÊñáÂ≠óÂàó„ÅßÂõ≤„Çè„Å™„Åã„Å£„ÅüÂ†¥Âêà', async () => {
    await cmp('N={hoge:30};N["hoge"]„ÇíË°®Á§∫„ÄÇ', '30')
  })
  it('ÊñáÂ≠óÂàó‚ÜíÊï∞ÂÄ§„Å∏„ÅÆÊöóÈªôÁöÑÂ§âÊèõ', async () => {
    await cmp('A="5";B="50";A+B„ÇíË°®Á§∫', '55')
    await cmp('"100"/"2"„ÇíË°®Á§∫', '50')
    await cmp('"2"*"3"„ÇíË°®Á§∫', '6')
    await cmp('"100"%"10"„ÇíË°®Á§∫', '0')
  })
  it('Á©∫ÈÖçÂàó„ÉÜ„Çπ„Éà', async () => {
    await cmp('A=Á©∫ÈÖçÂàó;A@0=30;A@1=50;A„Çí„Äå:„Äç„ÅßÈÖçÂàóÁµêÂêà„Åó„Å¶Ë°®Á§∫', '30:50')
    await cmp('A=Á©∫ÈÖçÂàó;B=Á©∫ÈÖçÂàó;A@0=30;A@1=50;B@0=1;B„Çí„Äå:„Äç„ÅßÈÖçÂàóÁµêÂêà„Åó„Å¶Ë°®Á§∫', '1')
  })
  it('ÂçòÈ†ÖÊºîÁÆóÂ≠ê minus number', async () => {
    await cmp('-1*5„ÇíË°®Á§∫', '-5')
    await cmp('5*-1„ÇíË°®Á§∫', '-5')
  })
  it('ÂçòÈ†ÖÊºîÁÆóÂ≠ê minus word', async () => {
    await cmp('A=1;5*-A„ÇíË°®Á§∫', '-5')
  })
  it('Ë´ñÁêÜÊºîÁÆó', async () => {
    await cmp('BMI=25;A=((25 ‚â¶ BMI) „Åã„Å§ (BMI < 30));A„ÇíË°®Á§∫', 'true')
    await cmp('BMI=25;A=((18.5 > BMI) „Åæ„Åü„ÅØ (BMI > 30));A„ÇíË°®Á§∫', 'false')
  })
  it('„Ç´„ÉÉ„Ç≥ÂÜÖ„ÅÆÈñ¢Êï∞Âëº„Å≥Âá∫„Åó', async () => {
    await cmp('N=("ABC"„ÅÆÊñáÂ≠óÊï∞);N„ÇíË°®Á§∫„ÄÇ', '3')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞Âä†ÁÆó', async () => {
    await cmp('N1=30;„Äå--{N1+1}--„Äç„ÇíË°®Á§∫', '--31--')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞Ê∏õÁÆó', async () => {
    await cmp('N1=30;„Äå--{N1-1}--„Äç„ÇíË°®Á§∫', '--29--')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞‰πóÁÆó', async () => {
    await cmp('N1=30;„Äå--{N1*2}--„Äç„ÇíË°®Á§∫', '--60--')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞Èô§ÁÆó', async () => {
    await cmp('N1=30;„Äå--{N1/2}--„Äç„ÇíË°®Á§∫', '--15--')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞Ââ∞‰Ωô', async () => {
    await cmp('N1=30;„Äå--{N1%2}--„Äç„ÇíË°®Á§∫', '--0--')
  })
  it('ÊñáÂ≠óÂàó„ÅÆÂüã„ÇÅËæº„ÅøÂ§âÊï∞ÂÜ™‰πó', async () => {
    await cmp('N1=2;„Äå--{N1^3}--„Äç„ÇíË°®Á§∫', '--8--')
  })
  it('ÊØîËºÉÊºîÁÆóÂ≠ê', async () => {
    await cmp('A=1>5;A„ÇíË°®Á§∫', 'false')
  })
  it('„Éì„ÉÉ„ÉàÊºîÁÆó', async () => {
    await cmp('A=0xF0>>4;A„ÇíË°®Á§∫', '15')
    await cmp('A=0xF<<4;A„ÇíË°®Á§∫', '240')
  })
  it('ÈÄ£Êñá„ÅßË®àÁÆó (#729)', async () => {
    await cmp('1„Å´2„ÇíË∂≥„Åó„Å¶3„ÇíË∂≥„Åó„Å¶4„ÇíÂºï„ÅÑ„Å¶5„ÇíÊéõ„Åë„Å¶2„ÅßÂâ≤„Å£„Å¶Ë°®Á§∫', '5')
    await cmp('2„Å´3„ÇíÊéõ„Åë„Å¶4„ÇíË∂≥„Åó„Å¶5„ÅßÂâ≤„Å£„Å¶Ë°®Á§∫', '2')
  })
  it('Âé≥Ê†º„Å™ÊØîËºÉ (#999)', async () => {
    await cmp('N=„Äå„Äç;„ÇÇ„Åó„ÄÅN=0„Å™„Çâ„Å∞„ÄåOK„Äç„Å®Ë°®Á§∫„ÄÇ', 'OK')
    await cmp('N=„Äå„Äç;„ÇÇ„Åó„ÄÅN===0„Å™„Çâ„Å∞„ÄåNG„Äç„Å®Ë°®Á§∫„ÄÇÈÅï„Åà„Å∞„ÄåOK„Äç„Å®Ë°®Á§∫„ÄÇ', 'OK')
  })
  it('„Å™„Åß„Åó„ÅìÂºèÈñ¢Êï∞Âëº„Å≥Âá∫„Åó„Åß„ÄÅÈÄî‰∏≠„Å´ÂõõÂâáÊºîÁÆó„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆÂá¶ÁêÜ (#1188)', async () => {
    await cmp('3.14„ÅÆINT+2„ÇíË°®Á§∫„ÄÇ', '5')
    await cmp('3„ÅÆ5ÂÄç√ó2„ÇíË°®Á§∫', '30')
    await cmp('1+3„ÅÆ2ÂÄç√ó2„ÇíË°®Á§∫', '16')
  })
  it('ÈÄ£ÊñáÂëº„Å≥Âá∫„Åó„Å´„Åä„Åë„Çã„Çπ„Çø„ÉÉ„ÇØ„ÅÆ‰ΩôÂâ∞„ÉÅ„Çß„ÉÉ„ÇØ„ÇíÂé≥„Åó„Åè„Åô„Çã #87', async () => {
    await cmp('3„Å´5„ÇíË∂≥„Åó„Å¶2„ÇíÊéõ„Åë„Å¶Ë°®Á§∫', '16')
    await cmp('„Äå  „ÅÇ„ÅÇ„ÅÇ  „Äç„ÅÆ„Äå„ÅÇ„Äç„Çí„Äå„Åà„Äç„Å´ÁΩÆÊèõ„Åó„Å¶Á©∫ÁôΩÈô§Âéª„Åó„Å¶Ë°®Á§∫', '„Åà„Åà„Åà')
    await errorTest('3„ÅÆ„Äå  „ÅÇ„ÅÇ„ÅÇ  „Äç„ÅÆ„Äå„ÅÇ„Äç„Çí„Äå„Åà„Äç„Å´ÁΩÆÊèõ„Åó„Å¶Á©∫ÁôΩÈô§Âéª„Åó„Å¶Ë°®Á§∫', 'NakoSyntaxError', 'Êú™Ëß£Ê±∫„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åô')
    await errorTest('9„ÅÆ1„Å´2„ÇíË∂≥„Åó„Å¶5„ÇíË∂≥„Åó„Å¶Ë°®Á§∫', 'NakoSyntaxError', 'Êú™Ëß£Ê±∫„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åô')
  })
  it('‰ª£ÂÖ•Êñá„Å´„Åä„Åë„ÇãÈÄ£Êñá #88', async () => {
    await cmp('N=„Äå„ÅÇ„ÅÇ„ÅÇ„Äç„ÅÆ„Äå„ÅÇ„Äç„Çí„Äå„Åà„Äç„Å´ÁΩÆÊèõ„Åó„Å¶Á©∫ÁôΩÈô§Âéª„ÄÇN„ÇíË°®Á§∫„ÄÇ', '„Åà„Åà„Åà')
    await errorTest('N=30„ÅÆ„Äå„ÅÇ„ÅÇ„ÅÇ„Äç„ÅÆ„Äå„ÅÇ„Äç„Çí„Äå„Åà„Äç„Å´ÁΩÆÊèõ„Åó„Å¶Á©∫ÁôΩÈô§Âéª„ÄÇN„ÇíË°®Á§∫„ÄÇ', 'NakoSyntaxError', 'Êú™Ëß£Ê±∫„ÅÆÂçòË™û„Åå„ÅÇ„Çä„Åæ„Åô')
  })
  it('ÊºîÁÆóÂ≠ê„Äå**„Äç(#1424)', async () => {
    await cmp('2**3„ÇíË°®Á§∫;', '8')
    await cmp('2^3„ÇíË°®Á§∫;', '8')
    await cmp('2**4„ÇíË°®Á§∫;', '16')
  })
  it('‰ª£ÂÖ•Êñá„Å´„Åä„Åë„ÇãÈñ¢Êï∞Âëº„Å≥Âá∫„Åó(#1449)', async () => {
    await cmp('N=(„Äåabc„Äç„ÅÆÊñáÂ≠óÊï∞)+1;N„ÇíË°®Á§∫;', '4')
    await cmp('N=„Äåabc„Äç„ÅÆÊñáÂ≠óÊï∞+1;N„ÇíË°®Á§∫;', '4')
    await cmp('N=1„Å´2„ÇíË∂≥„Åó„Å¶5„ÇíÊéõ„Åë„Çã+1;N„ÇíË°®Á§∫;', '16')
    await cmp('N=ÊñáÂ≠óÊï∞("abc")+1;N„ÇíË°®Á§∫;', '4')
    await cmp('N=1„Å´2„ÇíË∂≥„Åô+2„Å´3„ÇíÊéõ„Åë„Çã;N„ÇíË°®Á§∫;', '15')
  })
  it('bigintË∂≥„ÅóÁÆó', async () => {
    await cmp('3n+5n„ÇíË°®Á§∫', '8')
    await cmp('1234567890123456789n+9876543219876543210n„ÇíË°®Á§∫', '11111111109999999999')
    await cmp('a=1234567890123456789n;a+9876543219876543210n„ÇíË°®Á§∫', '11111111109999999999')
    await cmp('a=1234567890123456789n;b=9876543219876543210n;a+b„ÇíË°®Á§∫', '11111111109999999999')
  })
  it('bigintÂõõÂâáÊºîÁÆó', async () => {
    await cmp('3n-5n„ÇíË°®Á§∫', '-2')
    await cmp('9876543219876543210n-1234567890123456789n„ÇíË°®Á§∫', '8641975329753086421')
    await cmp('a=9876543219876543210n;a-1234567890123456789n„ÇíË°®Á§∫', '8641975329753086421')
    await cmp('a=9876543219876543210n;1234567890123456789n-a„ÇíË°®Á§∫', '-8641975329753086421')
    await cmp('a=9876543219876543210n;b=1234567890123456789n;a-b„ÇíË°®Á§∫', '8641975329753086421')

    await cmp('3n*5n„ÇíË°®Á§∫', '15')
    await cmp('1234567890123456789n*9876543219876543210n„ÇíË°®Á§∫', '12193263124676116323609205901126352690')
    await cmp('a=1234567890123456789n;a*9876543219876543210n„ÇíË°®Á§∫', '12193263124676116323609205901126352690')
    await cmp('a=1234567890123456789n;9876543219876543210n*a„ÇíË°®Á§∫', '12193263124676116323609205901126352690')
    await cmp('a=1234567890123456789n;b=9876543219876543210n;a*b„ÇíË°®Á§∫', '12193263124676116323609205901126352690')

    await cmp('10n/3n„ÇíË°®Á§∫', '3')
    await cmp('10n/-3n„ÇíË°®Á§∫', '-3')
    await cmp('-10n/3n„ÇíË°®Á§∫', '-3')
    await cmp('-10n/-3n„ÇíË°®Á§∫', '3')
    await cmp('98765432198765432109876543210n/1234567890123456789n„ÇíË°®Á§∫', '80000000801')
    await cmp('98765432198765432109876543210987654321987654321n/1234567890123456789n„ÇíË°®Á§∫', '80000000801000007290800066347')
    await cmp('a=98765432198765432109876543210987654321987654321n;a/1234567890123456789n„ÇíË°®Á§∫', '80000000801000007290800066347')
    await cmp('b=1234567890123456789n;98765432198765432109876543210987654321987654321n/b„ÇíË°®Á§∫', '80000000801000007290800066347')
    await cmp('a=98765432198765432109876543210987654321987654321n;b=1234567890123456789n;a/b„ÇíË°®Á§∫', '80000000801000007290800066347')

    await cmp('10n%3n„ÇíË°®Á§∫', '1')
    await cmp('10n%-3n„ÇíË°®Á§∫', '1')
    await cmp('-10n%3n„ÇíË°®Á§∫', '-1')
    await cmp('-10n%-3n„ÇíË°®Á§∫', '-1')
    await cmp('98765432198765432109876543210n%1234567890123456789n„ÇíË°®Á§∫', '9000987655221')
    await cmp('98765432198765432109876543210987654321987654321n%1234567890123456789n„ÇíË°®Á§∫', '13091059800074538')
    await cmp('a=98765432198765432109876543210987654321987654321n;a%1234567890123456789n„ÇíË°®Á§∫', '13091059800074538')
    await cmp('b=1234567890123456789n;98765432198765432109876543210987654321987654321n%b„ÇíË°®Á§∫', '13091059800074538')
    await cmp('a=98765432198765432109876543210987654321987654321n;b=1234567890123456789n;a%b„ÇíË°®Á§∫', '13091059800074538')

    await cmp('10n ** 3n„ÇíË°®Á§∫', '1000')
    await cmp('3n ** 60n„ÇíË°®Á§∫', '42391158275216203514294433201')
    await cmp('-3n ** 60n„ÇíË°®Á§∫', '42391158275216203514294433201')
    await cmp('-3n ** 61n„ÇíË°®Á§∫', '-127173474825648610542883299603')
  })
  it('bigintÂçòÈ†ÖÊºîÁÆóÂ≠ê', async () => {
    await cmp('-3n*5n„ÇíË°®Á§∫', '-15')
    await cmp('-1234567890123456789n*9876543219876543210n„ÇíË°®Á§∫', '-12193263124676116323609205901126352690')
    await cmp('1234567890123456789n*-9876543219876543210n„ÇíË°®Á§∫', '-12193263124676116323609205901126352690')
    await cmp('-1234567890123456789n*-9876543219876543210n„ÇíË°®Á§∫', '12193263124676116323609205901126352690')

    await cmp('a=1234567890123456789n;a*-9876543219876543210n„ÇíË°®Á§∫', '-12193263124676116323609205901126352690')
  })


  it('bigintÊØîËºÉÊºîÁÆóÂ≠ê', async () => {
    await cmp('a= 1234567890123456789n > 9876543219876543210n; a„ÇíË°®Á§∫', 'false')
    await cmp('a= 1234567890123456789n > 9876543219876543210; a„ÇíË°®Á§∫', 'false')
    await cmp('a= 1234567890123456789 > 9876543219876543210n; a„ÇíË°®Á§∫', 'false')
    await cmp('a= 1234567890123456789n < 9876543219876543210n; a„ÇíË°®Á§∫', 'true')
    await cmp('a= 1234567890123456789n < 9876543219876543210; a„ÇíË°®Á§∫', 'true')
    await cmp('a= 1234567890123456789 < 9876543219876543210n; a„ÇíË°®Á§∫', 'true')
  })

  it('bigint„Éì„ÉÉ„ÉàÊºîÁÆó', async () => {
    await cmp('1234567890123456789n<<60n„ÇíË°®Á§∫', '1423359869420436337641010675071320064')
    await cmp('123456789012345678901234567890123456789n>>60n„ÇíË°®Á§∫', '107081695084215790682')
  })

  it('‰ºº„Åü„Éï„Ç©„É≥„ÉàÂïèÈ°åÔºö„Å™„Åß„Åó„Åì3„Åß„Äå‚úï„Äç„ÅßÊéõ„ÅëÁÆó„Åï„Åõ„Çã #1781', async () => {
    // multiple
    await cmp('(2*3)„ÇíË°®Á§∫', '6')
    await cmp('(2‚úï3)„ÇíË°®Á§∫', '6') // 0x2715
    await cmp('(2‚úñ3)„ÇíË°®Á§∫', '6') // 0x2716
    await cmp('(2‚úó3)„ÇíË°®Á§∫', '6') // 0x2717
    await cmp('(2‚úò3)„ÇíË°®Á§∫', '6') // 0x2718
    await cmp('(2‚ùå3)„ÇíË°®Á§∫', '6') // 0x274C
    // others
    await cmp('(2‚ûï3)„ÇíË°®Á§∫', '5')
    await cmp('(20‚ûñ3)„ÇíË°®Á§∫', '17')
    await cmp('(21√∑3)„ÇíË°®Á§∫', '7')
    await cmp('(21‚ûó3)„ÇíË°®Á§∫', '7')
    await cmp('(20‚ûñ3)„ÇíË°®Á§∫', '17')
    await cmp('Aüü∞3;A„ÇíË°®Á§∫', '3')
  })

  it('„ÄåÂ¢ó„ÇÑ„Åô„Äç„ÄåÊ∏õ„Çâ„Åô„ÄçÊñá„ÅÆÂØæË±°„ÅåÊñáÂ≠óÂàó„ÅÆ„Å®„ÅçÊñáÂ≠óÂàóÁµêÂêà„Åó„Å¶„Åó„Åæ„ÅÜ #1956', async () => {
    await cmp('N="1";N„Çí1Â¢ó„ÇÑ„Åô„ÄÇN„ÇíË°®Á§∫„ÄÇ', '2')
    await cmp('N="2";N„Çí1Ê∏õ„Çâ„Åô„ÄÇN„ÇíË°®Á§∫„ÄÇ', '1')
    await cmp('N="2";N„Çí"1"Ê∏õ„Çâ„Åô„ÄÇN„ÇíË°®Á§∫„ÄÇ', '1')
  })
})
